<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
    PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
    "http://mybatis.org/dtd/mybatis-3-mapper.dtd">


<mapper namespace="shop">
	<select id="shop_list" parameterType="int" resultType="dto.FoodsDTO">
		select * from fb_foods where foods_no = #{foods_no} order by foods_no
		desc
	</select>

	<select id="count" resultType="int" parameterType="dto.FoodsDTO">
		select
		count(*) from fb_foods where category_no = #{category_no}
	</select>

	<select id="page_list" parameterType="map" resultType="dto.FoodsDTO">
		<![CDATA[
		select b.* from(
		select rownum as rm, a.* from(
		select * from fb_foods where category_no=#{category_no} order by foods_no desc )a)b
		where b.rm>=#{startRow} and b.rm <=#{endRow}
		]]>
	</select>
	
	
	<resultMap type="dto.FoodsDTO" id="food_rev_result" autoMapping="false">
	<result column="foods_no" property="foods_no" />
	<!-- ofType은 List<요기> 요기와같음 -->
	<collection property="rdto" javaType="java.util.List" ofType="dto.ReviewDTO">
		<result column="review_no" property="review_no" />
		<result column="review_writer" property="review_writer" />
		<result column="review_content" property="review_content" />
		<result column="review_date" property="review_date" />
	</collection>
</resultMap>

	<select id="review_list" resultMap="food_rev_result" parameterType="int">
		select r.review_no, r.review_writer, r.review_content, r.review_date
		from fb_review r, fb_foods f
		where  r.foods_no = f.foods_no and r.foods_no = #{foods_no}
		order by r.review_no desc
	</select>

</mapper>

